box: wercker/golang
build:
  steps:
    # golint step!
    # - wercker/golint

    # Build the project
    - script:
        name: go install
        code: |
          mkdir -p ${WERCKER_ROOT}/src/github.com/constabulary
          mv * ${WERCKER_ROOT}/src/github.com/constabulary/
          go install -v github.com/constabulary/gb/...

    # Test the project
    - script:
        name: go test
        code: |
          go test github.com/constabulary/gb/...

    # Integration tests
    - script:
        name: integration test/sqlite3
        code: | 
          git clone --quiet https://github.com/constabulary/integration-tests
          gb vendor -v -R ${WERCKER_ROOT}/integration-tests/sqlite3 restore
          gb build -v -R ${WERCKER_ROOT}/integration-tests/sqlite3
